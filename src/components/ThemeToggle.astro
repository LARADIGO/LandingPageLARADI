---
/* Componente UI muy pequeÃ±o: botÃ³n que alterna tema.
   No necesita props. */
---
<button id="theme-toggle" class="theme-toggle" aria-label="Cambiar tema" title="Cambiar tema" aria-pressed="false">
  <!-- icono sencillo: sol/luna -->
  <span class="icon-sun" aria-hidden="true">â˜€ï¸</span>
  <span class="icon-moon" aria-hidden="true" style="display:none">ğŸŒ™</span>
</button>

<script type="module" client:load>
  const btn = document.getElementById('theme-toggle');
  const root = document.documentElement;

  // Inicializa desde localStorage (si hay) o respetamos prefers-color-scheme
  const saved = localStorage.getItem('theme'); // 'dark' | 'light' | null
  if (saved === 'dark') root.classList.add('dark-theme');
  else if (saved === 'light') root.classList.remove('dark-theme');

  const updateUI = () => {
    const isDark = root.classList.contains('dark-theme');
    btn.setAttribute('aria-pressed', String(isDark));
    btn.querySelector('.icon-sun').style.display = isDark ? 'none' : '';
    btn.querySelector('.icon-moon').style.display = isDark ? '' : 'none';
  };

  updateUI();

  const reduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  btn.addEventListener('click', () => {
    if (!reduce) {
      root.classList.add('theme-anim');
      // mÃ¡s suave: dejamos la clase algo mÃ¡s de tiempo para cubrir la transiciÃ³n CSS
      setTimeout(() => root.classList.remove('theme-anim'), 520); // antes ~350ms
    }
    const isNowDark = root.classList.toggle('dark-theme');
    localStorage.setItem('theme', isNowDark ? 'dark' : 'light');
    updateUI();
  });
</script>